# start `nginx.conf` (v20180605)
load_module /usr/lib/nginx/modules/ngx_ipscrub_module.so;
load_module /usr/lib/nginx/modules/ngx_http_geoip_module.so;
load_module /usr/lib/nginx/modules/ngx_http_image_filter_module.so;
load_module /usr/lib/nginx/modules/ngx_http_xslt_filter_module.so;
load_module /usr/lib/nginx/modules/ngx_pagespeed.so;
load_module /usr/lib/nginx/modules/ngx_stream_module.so;
pid /var/run/nginx.pid;
user www-data;
worker_processes auto;

events {
      worker_connections 768;
}

http {#check https://cipherli.st for latest
      #dependencies
      log_format ipscrubbed '$remote_addr_ipscrub - $remote_user [$time_local] "$request" $status $body_bytes_sent "$http_referer" "$http_user_agent" "$http_x_forwarded_for"';
      #standard stuff
      access_log /var/log/nginx/access.log ipscrubbed;
      charset UTF-8;
      client_max_body_size 128M;
      default_type application/octet-stream;
      error_log /var/log/nginx/error.log crit;
      gzip on;
      gzip_disable "msie6";
      include /etc/nginx/mime.types;
      keepalive_timeout 65; #investigate
      log_not_found off;
      resolver 1.1.1.1 9.9.9.9 [2606:4700:4700::1111] [2620:fe::fe] valid=30s;
      resolver_timeout 5s;
      sendfile on;
      server_tokens off;
      ssl_buffer_size 8k;
      ssl_ciphers ECDHE-RSA-AES256-GCM-SHA512:DHE-RSA-AES256-GCM-SHA512:ECDHE-RSA-AES256-GCM-SHA384:DHE-RSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-SHA384;
      ssl_dhparam /etc/nginx/ssl/dhparam.pem;
      ssl_ecdh_curve secp384r1;
      ssl_prefer_server_ciphers on;
      ssl_protocols TLSv1 TLSv1.1 TLSv1.2 TLSv1.3;
      ssl_session_cache shared:SSL:10m;
      ssl_session_tickets off;
      ssl_session_timeout 10m;
      ssl_stapling on;
      ssl_stapling_verify on;
      tcp_nodelay on;
      tcp_nopush on;
      types_hash_max_size 2048;
      #last but not least
      include /etc/nginx/sites-enabled/*.*;
}
#end `nginx.conf`
